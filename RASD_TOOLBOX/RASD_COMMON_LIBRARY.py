"""
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWX0xl;'''';:cdOXWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWNKko:,''''''''''',:okKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWN0xl;''''''''''''''''''';lx0XWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWKOdc,'''''''',:lddo:;,'''''''',:okKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWN0xl;,'''''''';cdOXWWWWXK0dc;''''''''';lx0NWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWXOdc,'''''''',:lx0NWWWWWWWWWWWNKko:,'''''''',cdOKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWNKko:,'''''''',cdOXNWWWWN0kddk0XNWWWWWXOdc;'''''''',;lx0NWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWXOdc;''''''''';lx0NWWWWWXOdc,'''',;cdOXWWWWWN0ko:,'''''''',cdOXWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWXko:,'''''''',:okKNWWWWNKko:,''''''''''',:lxKWWWWWWXOdc,'''''''',:lkKWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWW0c''''''''';lx0XWWWWWXOdc;''''''''''''''''',cOWWWWWWWWWN0xl;,'''''''':OWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''''';okKNWWWWNKko:,'''''''',:oddoc;;:lx0NWWWWWX0KNWWWWWKOo:'''''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''''c0WWWWWN0xl;''''''''';lx0XWWWWNXKXNWWWWNKko:,;cdOXWWWWWKl''''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWWWNk;'''''''''',l0NWWWWWWWWWWWWWX0xl;''''''',:o0WWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWWWWKdc,''''''''';okKNWWWWWWWWKko:,'''''''''''''oNWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWWWWWWN0xl;''''''''';lxOKKOxdl;,'''''''';;,'''''oXWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWWNNWWWWWNKko:,'''''''',,,,''''''''',:okKk;'''''oXWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNkclx0NWWWWWX0dc;''''''''''''''';cdOXWWWO;'''''oXWWWx,'''',xWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''';cxXWWWWWWNKko:,''''''',:okKNWWWWWWO;'''''oXWWWx,',:okXWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''''';kWWWWWWWWWWXOdl::cdxOXWWWWWWWWWWO;'''''oXWWW0dxOXWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''''';kWWWWWWWWWWWWWNNXNWWWWWWWWWWWWWWO;'''''oXWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''''';kWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWO;'''''oXWWWWWWN0xd0WWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''''';kWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWO;'''''oXWWWXOdc,',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd''''';kWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWO;'''''oXWWWk;'''',dNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk;'''',xWWWNd''''',dXWWWWWWWWWWWWWWWWWWWWWWWWWWWWWNx;'''''oXWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNd'''''',cdOXWWWWWWWWWWWWWWWWWWWWWWWXOdl;''''''oXWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',xWWWNk;'''''''',:okKNWWWWWWWWWWWWWWWNKko:,'''''''',xNWWWx,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,'''',dNWWWN0xl;''''''''';lx0XWWWWWWWWWN0xl;''''''''';cd0NWWWNd,'''',xNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWk,''''';dKNWWWWNKko:,'''''''',:okKXXKOxdc,'''''''',:okKNWWWWNKx;''''',dNWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWO;''''''';lx0XWWWWWX0xc;''''''''';::;,''''''''';cdOXWWWWWN0xl;''''''',xWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWX0xl;''''''''';lx0NWWWWWXOdc;''''''''',cdOXWWWWWN0kl:,'''''''',cdOXWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWNKko:,'''''''',cdOKWWWWWNKxl:;,:ldx0NWWWWWXOdc;'''''''',:lk0NWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWXOdc;'''''''',;lx0NWWWWWXKKXWWWWWWNKko:,'''''''',cdOXNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWNKko:,'''''''',cdOXWWWWWWWWWXOxc;''''''''';lx0NWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWXOdc,'''''''',:lk0XXKkxo:,'''''''',:dOKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWXOdc,''''''''''''''',:okKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWN0xl;''''''''';cxOXWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWNKkoc:;:odkKNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWNXXNWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WWWWWWWWOooooooooooooooodx0NWWWWXOdooooooooooooodOXWWWWNX0xdoooooooooooooooONWNOdooooooooooooooox0NWWWW
WWWWWWWWo''''''''''''''''';xNWWKl,''''''''''''''',oKWWNx:;'''''''''''''''''oNMNd''''''''''''''''';xNWWW
WWWWWWWWd'',okkkkkkkkkkd;''cKWWk;''ckkkkkkkkkkxc'';OWWKc''';dkkkkkkkkkOkkkOKWWNd'',okkkkkkkkOOd;''cKWWW
WWWWWWWWd'';kWWWWWWWWWW0c''cKWWk;''dXWWWWWWWWWXo'';OWWKc'''c0WWWWWWWWWWWWWWWWWNd'';kWWWWWWWWWWKc''cKWWW
WWWWWWWWd''':llllllllllc,''lXWWk;'';lllllllllll;'';OWWXl''',cllllllllllloxKWWWNd'';kWWWWWWWWWWKc''cKWWW
WWWWWWWWd'''''''''''',,,,;l0WWWk;''''',,''',,''''';OWWW0xl;,'''''',',,,''':OWWNd'';kWWWWWWWWWWKc''cKWWW
WWWWWWWWd'',oOko;''';dOO0KNWWWWk;''lkOOOOOOOOOkc'';OWWWWWNK0OOOOOOOOOOOo,''dNWNd'';kWWWWWWWWWWKc''cKWWW
WWWWWWWWd'';kWWN0o;'';dKNNNNWWWk;',dNWWWWWWWWMNo'';OWWWWNNWNNNNNNNNNNNNk;''oNWNd'';kNNNNNNNNNN0c''cKWWW
WWWWWWWWd'';kWWWWN0o;'';cccdXWWk;',dNWWWWWWWWWNo'';OWWXxccccccccccccccc:'',xNWNd''':cccccccccc:,''lXWWW
WWWWWWWWd;,:OWWWWWWN0o;,,,,lKMWk:,;xNWWWWWWWWWNd,,:OWWKl,,,,,,,,,,,,,,,,;:xXWWNd;,,,,,,,,,,,,,,,:o0WWWW
"""
################################################################################
# UNIVERSIDADE FEDERAL DE CATALÃO (UFCAT)
# WANDERLEI MALAQUIAS PEREIRA JUNIOR                   ENG. CIVIL / PROF (UFCAT)
# ROMES ANTÔNIO BORGES                                       MAT. / PROF (UFCAT)
# DONIZETTI A. DE SOUZA JÚNIOR                                ENG. CIVIL (UFCAT)
################################################################################

################################################################################
# DESCRIÇÃO ALGORITMO:
# BIBLIOTECA RASD DE ALGORITMOS ESTOCÁSTICOS DE CONFIABILIDADE DESENVOLVIDOS
# PELO GRUPO DE PESQUISA DE ESTUDOS EM ENGENHARIA (GPEE)
################################################################################

################################################################################
# BIBLIOTECAS NATIVAS PYTHON
from pyDOE import *
import numpy as np
from scipy.stats.distributions import norm
from scipy.stats.distributions import gumbel_r
from scipy.stats.distributions import gumbel_l
from scipy.stats.distributions import lognorm
from scipy.stats.distributions import uniform

################################################################################
# BIBLIOTECAS DESENVOLVEDORES GPEE

# CRIAÇÃO DAS AMOSTRAS VIA MÉTODOS ESTOCÁSTICOS 
def SAMPLING(N_POP, D, MODEL, VARS):
    """
    This function generates random samples according to chosen sampling method.
    
    Input:
    N_POP            |  Total of samplings                      | Integer
    D                |  Number of variables                     | Integer  
    MODEL            |  Algorithm setup                         | String
                     |      'MCS': Monte Carlo Sampling         |
                     |      'LHS': Latim Hypercube Sampling     | 
    VARS             |  Description of variables                | Py list[D]
                     |      Example:                            |
                     |      V_1 = ['NORMAL', 500, 100]          |
                     |      V_2 = ['NORMAL', 1000, 1000]        |
                     |      VARS = [V_1, V_2]                   |

    Output:
    RANDOM_SAMPLING  |  Samples                                 | Py Numpy array[N_POP x D]
    """
    # Creating variables
    RANDOM_SAMPLING = np.zeros((N_POP, D))
    # Monte Carlo sampling
    if MODEL == 'MCS':
        for I_COUNT in range(D):
            # Type of distribution, mean and standard deviation
            TYPE = VARS[I_COUNT][0]
            MEAN = VARS[I_COUNT][1]
            STD = VARS[I_COUNT][2]
            # Normal or Gaussian
            if (TYPE == 'GAUSSIAN' or TYPE == 'NORMAL'):
                RANDOM_SAMPLING[:, I_COUNT] = norm.rvs(loc = MEAN, scale = STD, size = N_POP, random_state = None)
            # Gumbel right or Gumbel maximum
            elif TYPE == 'GUMBEL MAX':
                RANDOM_SAMPLING[:, I_COUNT] = gumbel_r.rvs(loc = MEAN, scale = STD, size = N_POP, random_state = None)
            # Gumbel left or Gumbel minimum
            elif TYPE == 'GUMBEL MIN':
                RANDOM_SAMPLING[:, I_COUNT] = gumbel_l.rvs(loc = MEAN, scale = STD, size = N_POP, random_state = None)
            # Lognormal
            elif TYPE == 'LOGNORMAL':
                RANDOM_SAMPLING[:, I_COUNT] = lognormal.rvs(loc = MEAN, scale = STD, size = N_POP, random_state = None)
            # Uniform
            elif TYPE == 'UNIFORM':
                RANDOM_SAMPLING[:, I_COUNT] = uniform.rvs(loc = MEAN, scale = STD, size = N_POP, random_state = None)
    # Latin Hyper Cube Sampling            
    elif MODEL == 'LHS':
        RANDOM_SAMPLING = lhs(D, criterion = 'center', samples = N_POP)
        for I_COUNT in range(D):
            # Type of distribution, mean and standard deviation
            TYPE = VARS[I_COUNT][0]
            MEAN = VARS[I_COUNT][1]
            STD = VARS[I_COUNT][2]  
            # Normal or Gaussian
            if (TYPE == 'GAUSSIAN' or TYPE == 'NORMAL'):
                RANDOM_SAMPLING[:, I_COUNT] = norm(loc = MEAN, scale = STD).ppf(RANDOM_SAMPLING[:, I_COUNT])
            # Gumbel right or Gumbel maximum       
            elif TYPE == 'GUMBEL MAX':
                RANDOM_SAMPLING[:, I_COUNT] = gumbel_r(loc = MEAN, scale = STD).ppf(RANDOM_SAMPLING[:, I_COUNT])
            # Gumbel left or Gumbel minimum
            elif TYPE == 'GUMBEL MIN':
                RANDOM_SAMPLING[:, I_COUNT] = gumbel_l(loc = MEAN, scale = STD).ppf(RANDOM_SAMPLING[:, I_COUNT])
            # Lognormal
            elif TYPE == 'LOGNORMAL':
                RANDOM_SAMPLING[:, I_COUNT] = lognormal(loc = MEAN, scale = STD).ppf(RANDOM_SAMPLING[:, I_COUNT])
            # Uniform
            elif TYPE == 'UNIFORM':
                RANDOM_SAMPLING[:, I_COUNT] = uniform(loc = MEAN, scale = STD).ppf(RANDOM_SAMPLING[:, I_COUNT])

    return RANDOM_SAMPLING